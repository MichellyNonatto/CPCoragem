{% extends "containers/mainContainer.html" %}
{% load static %}
{% block title %}
    Funcionários
{% endblock title %}
{% block containerTitle %}
    Funcionários/
    {% if acao == 'visualizar' %}
        detalhes
    {% elif acao == 'editar' %}
        edição
    {% else %}
        adicionar
    {% endif %}
{% endblock containerTitle %}
{% block container %}
    <div class="flex gap-8 w-full">
        <div class="flex flex-col justify-end gap-4 w-full py-2">
            <div class="flex gap-4 h-36">
                <img src="{% if object.imagem.url %}{{ object.imagem.url }}{% else %}{% static 'img/blank-profile.webp' %}{% endif %}"
                     alt="Imagem do funcionário"
                     width="128px"
                     height="128px"
                     id="preview-imagem"
                     class="h-32 w-32 rounded-full object-cover object-top" />
                {% if acao == 'editar' or acao == 'adicionar' %}
                    <div class="flex items-center gap-4">
                        <p class="text-primaryColor font-medium">Fazer upload de imagem</p>
                        <label for="id_imagem"
                               class="relative cursor-pointer bg-primaryColor hover:bg-onPrimaryFixedVariant focus:bg-primaryColor border border-primaryColor text-white rounded-md py-2 px-4 inline-flex items-center">
                            <span>Escolher Imagem</span>
                            <input type="file"
                                   name="imagem"
                                   id="id_imagem"
                                   accept="image/*"
                                   required
                                   onchange="previewImagem(this)"
                                   class="hidden">
                        </label>
                    </div>
                {% endif %}
            </div>
            <script>
                function previewImagem(input) {
                    var preview = document.getElementById('preview-imagem');
                    if (input.files && input.files[0]) {
                        var reader = new FileReader();
                        reader.onload = function (e) {
                            preview.src = e.target.result;
                        }
                        reader.readAsDataURL(input.files[0]);
                    }
                }
            </script>
            {% include "components/input.html" with acao=acao type="text" label="Nome completo" name="name" id="name" value=object.usuario.nome_completo %}
            {% include "components/input.html" with acao=acao type="text" label="Documento" name="document" id="document" value=object.usuario.get_documento_formatado.1 %}
            {% include "components/input.html" with acao=acao type="text" label="Email" name="email" id="email" value=object.usuario.email %}
            {% include "components/input.html" with acao=acao type="text" label="Telefone" name="phone" id="phone" value=object.usuario.telefone %}
            {% include "components/input.html" with acao=acao type="text" label="Função" name="function" id="function" value=object.funcao %}
        </div>
        <div class="flex flex-col justify-end gap-4 w-full">
            {% include "components/input.html" with acao=acao type="text" label="CEP" name="cep" id="cep" value=endereco.cep %}
            {% include "components/input.html" with acao=acao type="text" label="Estado" name="state" id="state" value=endereco.estado %}
            {% include "components/input.html" with acao=acao type="text" label="Cidade" name="city" id="city" value=endereco.cidade %}
            {% include "components/input.html" with acao=acao type="text" label="Bairro" name="neighborhood" id="neighborhood" value=endereco.bairro %}
            {% include "components/input.html" with acao=acao type="text" label="Rua" name="street" id="street" value=endereco.rua %}
            {% include "components/input.html" with acao=acao type="text" label="Número" name="number" id="number" value=endereco.numero %}
            {% include "components/input.html" with acao=acao type="text" label="Complemento" name="complement" id="complement" value=endereco.complemento %}
        </div>
    </div>
    <div class="w-full py-10 flex items-center justify-end gap-8">
        {% if acao == 'visualizar' %}
            {% include "components/anchor.html" with secondary=True href="usuarios:editarfuncionario" pk=funcionario.pk label="Editar Funcionário" %}
            {% include "components/anchor.html" with href="usuarios:deletarfuncionario" pk=funcionario.usuario_id label="Excluir Funcionário" %}
        {% else %}
            {% include "components/button.html" with secondary=True onclick="javascript:history.go(-1);" label="Cancelar" %}
            {% if acao == 'editar' %}
                {% include "components/button.html" with type="submit" label="Salvar edição" %}
            {% else %}
                {% include "components/button.html" with type="submit" label="Cadastrar funcionário" %}
            {% endif %}
        {% endif %}
    </div>
{% endblock container %}
